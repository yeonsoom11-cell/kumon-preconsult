<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>êµ¬ëª¬í™”ìƒí•™ìŠµ ì‚¬ì „ ìƒë‹´ì„¤ë¬¸</title>

  <!-- Pretendard ë¡œë“œ (í†µì¼ê°) -->
  <link rel="stylesheet" as="style" crossorigin
    href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@latest/dist/web/static/pretendard.css" />

  <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>

  <style>
    :root{
      --main-color:#4A90E2;
      --bg-color:#f0f2f5;
      --text:#222;
      --muted:#666;
      --card:#fff;
      --border:#e7e7e7;
      --ring: rgba(74,144,226,.25);
      --danger:#ff4d4d;
      --shadow: 0 10px 30px rgba(0,0,0,0.08);
      --shadow-soft: 0 6px 18px rgba(0,0,0,0.06);
      --radius: 18px;

      /* âœ… color-mix ëŒ€ì²´ìš©(ìº¡ì²˜ ì•ˆì •ì„±) */
      --card-80: rgba(255,255,255,0.80);
      --card-90: rgba(255,255,255,0.90);
      --card-92: rgba(255,255,255,0.92);
      --border-soft: rgba(231,231,231,0.65);
      --text-soft: rgba(34,34,34,0.85);
      --muted-soft: rgba(102,102,102,0.85);
      --main-10: rgba(74,144,226,0.10);
      --main-40: rgba(74,144,226,0.40);
      --main-70: rgba(74,144,226,0.70);
    }

    *{ box-sizing: border-box; }
    body{
      font-family: Pretendard, -apple-system, system-ui, sans-serif;
      background: var(--bg-color);
      margin:0;
      padding:15px;
      color: var(--text);
      line-height: 1.55;
    }

    .main-wrapper{
      display:flex;
      flex-wrap:wrap;
      justify-content:center;
      gap:20px;
      max-width:1000px;
      margin:auto;
    }

    .container{
      flex:1;
      min-width:320px;
      max-width:520px;
      background: var(--card);
      padding:24px;
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      border: 1px solid var(--border);
    }

    .preview-container{
      flex:1;
      min-width:320px;
      max-width:420px;
      position: relative;
    }

    /* ìƒë‹¨ ì§„í–‰ í‘œì‹œ(ìŠ¤í…í¼ + í”„ë¡œê·¸ë ˆìŠ¤) */
    .progress-wrap{
      margin-bottom: 16px;
      padding: 14px 14px 12px;
      border-radius: 14px;
      border: 1px solid var(--border);
      background: var(--card-80);
    }
    .steps-row{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
      margin-bottom: 10px;
    }
    .step-pill{
      display:flex;
      align-items:center;
      gap:8px;
      font-size: 13px;
      color: var(--muted);
      white-space: nowrap;
    }
    .dot{
      width: 22px;
      height: 22px;
      border-radius: 999px;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      font-size: 12px;
      border: 1px solid var(--border);
      color: var(--muted);
      background: var(--card-90);
    }
    .step-pill.active .dot,
    .step-pill.done .dot{
      border-color: var(--main-color);
      color: white;
      background: var(--main-color);
    }
    .step-pill.active,
    .step-pill.done{
      color: var(--text);
      font-weight: 600;
    }
    .bar{
      height: 8px;
      border-radius: 999px;
      background: var(--border-soft);
      overflow:hidden;
    }
    .bar > div{
      height: 100%;
      width: 33%;
      background: var(--main-color);
      border-radius: 999px;
      transition: width .25s ease;
    }
    .bar-caption{
      margin-top: 8px;
      font-size: 12px;
      color: var(--muted);
      display:flex;
      justify-content: space-between;
      align-items:center;
    }

    /* STEP */
    .step{ display:none; }
    .step.active{ display:block; }

    h2{
      font-size: 1.25rem;
      color: var(--text);
      margin: 6px 0 18px;
      border-left: 4px solid var(--main-color);
      padding-left: 10px;
      letter-spacing: -0.2px;
    }

    .input-group{ margin-bottom: 15px; }
    .input-group label{
      display:flex;
      align-items:center;
      gap:8px;
      font-weight: 700;
      margin-bottom: 8px;
      font-size: 0.92rem;
      color: var(--text-soft);
    }
    .req-badge{
      font-size: 12px;
      padding: 2px 8px;
      border-radius: 999px;
      border: 1px solid var(--main-40);
      color: var(--main-color);
      background: var(--main-10);
      font-weight: 700;
    }
    .help{
      margin-top: 6px;
      font-size: 12px;
      color: var(--muted);
    }

    input[type="text"], input[type="tel"], select, textarea{
      width:100%;
      padding: 12px 12px;
      border: 1px solid var(--border);
      border-radius: 12px;
      font-size: 1rem;
      background: var(--card-92);
      color: var(--text);
      transition: border-color .15s ease, box-shadow .15s ease;
      outline: none;
    }
    input[type="text"]::placeholder,
    input[type="tel"]::placeholder,
    textarea::placeholder{
      color: rgba(102,102,102,0.70);
    }
    input[type="text"]:focus,
    input[type="tel"]:focus,
    select:focus,
    textarea:focus{
      border-color: var(--main-color);
      box-shadow: 0 0 0 4px var(--ring);
    }

    /* ì˜¤ë¥˜ í‘œì‹œ */
    .is-error{
      border-color: var(--danger) !important;
      box-shadow: 0 0 0 4px rgba(255,77,77,0.20) !important;
    }
    .error-msg{
      margin-top: 7px;
      font-size: 12px;
      color: var(--danger);
      display:none;
    }
    .error-msg.show{ display:block; }

    /* ì˜µì…˜(ì¹©) */
    .options{
      display:grid;
      grid-template-columns: repeat(2, minmax(0,1fr));
      gap: 10px;
      margin-bottom: 10px;
    }
    .options label{
      border: 1px solid var(--border);
      padding: 12px 12px;
      border-radius: 14px;
      text-align:center;
      cursor:pointer;
      font-size: 0.88rem;
      background: var(--card-92);
      transition: transform .08s ease, box-shadow .15s ease, border-color .15s ease, background .15s ease;
      user-select:none;
      position: relative;
      overflow:hidden;
    }
    .options label:hover{
      box-shadow: var(--shadow-soft);
      transform: translateY(-1px);
    }
    input[type="radio"], input[type="checkbox"]{ display:none; }

    /* ì„ íƒ ì‹œ ì²´í¬ í‘œì‹œ + ê°•ì¡° */
    input[type="radio"]:checked + label,
    input[type="checkbox"]:checked + label{
      border-color: var(--main-70);
      background: var(--main-10);
      color: var(--main-color);
      font-weight: 800;
      box-shadow: 0 8px 18px rgba(74,144,226,0.18);
      transform: translateY(-1px);
    }
    input[type="radio"]:checked + label::after,
    input[type="checkbox"]:checked + label::after{
      content: "âœ“";
      position: absolute;
      right: 10px;
      top: 10px;
      width: 22px;
      height: 22px;
      border-radius: 999px;
      display:flex;
      align-items:center;
      justify-content:center;
      background: var(--main-color);
      color: white;
      font-size: 13px;
      box-shadow: 0 6px 14px rgba(74,144,226,0.30);
    }

    /* ë²„íŠ¼ */
    .nav-btns{
      display:flex;
      gap:10px;
      margin-top: 22px;
    }
    button{
      flex:1;
      padding: 14px;
      border-radius: 14px;
      border: 1px solid transparent;
      font-weight: 800;
      cursor:pointer;
      transition: transform .08s ease, box-shadow .15s ease, opacity .15s ease;
      letter-spacing: -0.2px;
    }
    button:active{ transform: translateY(1px); }

    .btn-next{
      background: var(--main-color);
      color:white;
      box-shadow: 0 10px 18px rgba(74,144,226,0.22);
    }
    .btn-next:hover{ box-shadow: 0 12px 22px rgba(74,144,226,0.28); }

    .btn-prev{
      background: transparent;
      border-color: var(--border);
      color: rgba(34,34,34,0.75);
    }
    .btn-prev:hover{ box-shadow: var(--shadow-soft); }

    .btn-save{ background:#28a745; color:white; box-shadow: 0 10px 18px rgba(40,167,69,0.18); }
    .btn-reset{ background: var(--danger); color:white; margin-top:10px; box-shadow: 0 10px 18px rgba(255,77,77,0.16); }

    /* ë¯¸ë¦¬ë³´ê¸° ì¹´ë“œ */
    .summary-card{
      position: sticky;
      top: 20px;
      background: var(--card);
      padding: 18px;
      border-radius: 16px;
      border: 2px solid var(--main-color);
      box-shadow: var(--shadow-soft);
    }
    .card-header{
      font-weight: 900;
      color: var(--main-color);
      border-bottom: 1px solid var(--border);
      padding-bottom: 10px;
      margin-bottom: 12px;
      text-align:center;
      letter-spacing: -0.2px;
    }
    .item{
      margin-bottom: 8px;
      font-size: 13px;
      display:flex;
      gap: 8px;
    }
    .item b{
      width: 90px;
      color: var(--muted-soft);
      flex-shrink:0;
    }

    .hidden{ display:none !important; }

    /* ìº¡ì²˜ ìœ ì§€(ì§€ê¸ˆì€ ìµœì¢… í™”ë©´ì—ì„œë„ ë¯¸ë¦¬ë³´ê¸° ë³´ì—¬ì•¼ í•´ì„œ sr-captureëŠ” ì‚¬ìš© ì•ˆ í•¨ / í•„ìš”ì‹œë§Œ ìœ ì§€) */
    .sr-capture{
      position: fixed !important;
      left: -10000px !important;
      top: -10000px !important;
      width: 420px;
      display: block !important;
      visibility: visible !important;
      opacity: 1 !important;
      pointer-events: none;
      z-index: -1;
    }

    .exit-guide{
      font-size: 12px;
      color: var(--muted);
      text-align:center;
      margin-top: 18px;
      line-height: 1.6;
      word-break: keep-all;
      padding: 0 10px;
    }

    /* âœ… í…ìŠ¤íŠ¸ ë³µì‚¬ fallback UI */
    .text-fallback{
      border: 1px solid var(--border);
      background: var(--card-92);
      border-radius: 14px;
      padding: 12px;
    }
    .text-fallback .tip{
      font-size: 12px;
      color: var(--muted);
      margin-bottom: 8px;
      line-height: 1.5;
      word-break: keep-all;
    }
    .text-fallback textarea{
      width: 100%;
      min-height: 170px;
      resize: vertical;
      font-size: 13px;
      line-height: 1.5;
      background: #fff;
    }
    .text-fallback .mini-btns{
      display:flex;
      gap:10px;
      margin-top: 10px;
    }
    .btn-outline{
      background: transparent;
      border: 1px solid var(--border);
      color: var(--text);
      box-shadow: none;
    }

    /* ëª¨ë°”ì¼: */
    .mobile-only{ display:none; }
    .sheet-overlay{
      display:none;
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.35);
      z-index: 999;
      opacity: 0;
      transition: opacity .2s ease;
    }
    .sheet{
      position: fixed;
      left: 0; right: 0; bottom: 0;
      z-index: 1000;
      transform: translateY(110%);
      transition: transform .25s ease;
      padding: 10px 12px 14px;
    }
    .sheet-inner{
      max-width: 520px;
      margin: 0 auto;
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 18px;
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .sheet-handle{
      width: 42px;
      height: 5px;
      border-radius: 999px;
      background: rgba(0,0,0,0.15);
      margin: 10px auto 6px;
    }
    .sheet-top{
      display:flex;
      align-items:center;
      justify-content: space-between;
      gap: 8px;
      padding: 10px 14px 12px;
      border-bottom: 1px solid var(--border);
    }
    .sheet-title{
      font-weight: 900;
      letter-spacing: -0.2px;
      font-size: 14px;
      color: var(--text);
    }
    .sheet-close{
      border: 1px solid var(--border);
      background: transparent;
      color: var(--text);
      padding: 8px 10px;
      border-radius: 12px;
      font-weight: 800;
      flex: 0 0 auto;
      box-shadow: none;
    }
    .sheet-body{ padding: 12px 14px 16px; }

    .preview-open-btn{
      width: 100%;
      padding: 12px;
      border-radius: 14px;
      border: 1px solid var(--border);
      background: var(--card-92);
      font-weight: 900;
      color: var(--text);
      margin-bottom: 14px;
      box-shadow: var(--shadow-soft);
    }

    @media (max-width: 768px){
      body{ padding: 12px; }
      .container{ padding: 18px; border-radius: 16px; }
      .main-wrapper{ gap: 14px; }
      .preview-container{ max-width: 520px; width: 100%; }

      .nav-btns{
        position: sticky;
        bottom: 0;
        background: var(--card-92);
        padding: 12px 0 6px;
        margin-top: 16px;
        z-index: 5;
        box-shadow: 0 -10px 18px rgba(0,0,0,0.05);
      }

      .mobile-only{ display:block; }

      body.sheet-open{ overflow: hidden; }
      body.sheet-open .sheet-overlay{ display:block; opacity: 1; }
      body.sheet-open .sheet{ transform: translateY(0%); }

      #final-action-area{ margin-top: 12px !important; }

      /* ëª¨ë°”ì¼ì—ì„œ ìµœì¢… ë¯¸ë¦¬ë³´ê¸°ëŠ” ë°˜ë“œì‹œ ë³´ì—¬ì•¼ í•˜ë¯€ë¡œ sticky í•´ì œ */
      .summary-card{ position: static; top: auto; }
    }
  </style>
</head>

<body>
  <div class="main-wrapper">
    <div class="container" id="form-side">
      <div class="progress-wrap" aria-label="ì§„í–‰ ìƒíƒœ">
        <div class="steps-row">
          <div class="step-pill" id="pill1"><span class="dot">1</span>ê¸°ë³¸ì •ë³´</div>
          <div class="step-pill" id="pill2"><span class="dot">2</span>ìƒì„¸ì •ë³´</div>
          <div class="step-pill" id="pill3"><span class="dot">3</span>ìƒë‹´í¬ë§</div>
        </div>
        <div class="bar" aria-hidden="true"><div id="progress-bar"></div></div>
        <div class="bar-caption">
          <span id="progress-text">STEP 1 / 3</span>
          <span>30ì´ˆë©´ ì‘ì„± ì™„ë£ŒğŸ™‚</span>
        </div>
      </div>

      <button type="button" class="preview-open-btn mobile-only" onclick="openPreviewSheet()">ğŸ“‹ ë¯¸ë¦¬ë³´ê¸° ë³´ê¸°</button>

      <div id="step1" class="step active">
        <h2>STEP 1. ê¸°ë³¸ ì •ë³´ ì…ë ¥</h2>

        <div class="input-group">
          <label>í•™ìŠµì ì´ë¦„ <span class="req-badge">í•„ìˆ˜</span></label>
          <input type="text" id="in_name" placeholder="ì´ë¦„ ì…ë ¥" oninput="updateLive(); clearFieldError('in_name');" />
          <div class="error-msg" id="err_in_name">ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.</div>
        </div>

        <div class="input-group">
          <label>ì—°ë½ì²˜ <span class="req-badge">í•„ìˆ˜</span></label>
          <input type="tel" id="in_phone" maxlength="13" placeholder="010-0000-0000"
            oninput="autoHyphen(this); updateLive(); clearFieldError('in_phone');" />
          <div class="help">ì˜ˆ: 010-1234-5678</div>
          <div class="error-msg" id="err_in_phone">ì—°ë½ì²˜ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.</div>
        </div>

        <div class="input-group">
          <label>ë¬¸ì˜ ì£¼ì‹  ë¶„ <span class="req-badge">í•„ìˆ˜</span></label>
          <div class="options">
            <input type="radio" name="who" id="who1" value="í•™ìŠµì ë³¸ì¸" onchange="updateLive(); clearGroupError('who');" />
            <label for="who1">í•™ìŠµì ë³¸ì¸</label>
            <input type="radio" name="who" id="who2" value="í•™ë¶€ëª¨" onchange="updateLive(); clearGroupError('who');" />
            <label for="who2">í•™ë¶€ëª¨</label>
          </div>
          <div class="error-msg" id="err_who">ë¬¸ì˜ ì£¼ì‹  ë¶„ì„ ì„ íƒí•´ì£¼ì„¸ìš”.</div>
        </div>

        <div class="input-group">
          <label>í•™ìŠµì ì—°ë ¹ëŒ€ <span class="req-badge">í•„ìˆ˜</span></label>
          <div class="options">
            <input type="radio" name="main_age" id="age_mid" value="ì¤‘ë“±" onchange="updateLive(); clearGroupError('main_age');" />
            <label for="age_mid">ì¤‘ë“±</label>
            <input type="radio" name="main_age" id="age_high" value="ê³ ë“±" onchange="updateLive(); clearGroupError('main_age');" />
            <label for="age_high">ê³ ë“±</label>
            <input type="radio" name="main_age" id="age_adult" value="ì„±ì¸" onchange="updateLive(); clearGroupError('main_age');" />
            <label for="age_adult">ì„±ì¸</label>
          </div>
          <div class="error-msg" id="err_main_age">í•™ìŠµì ì—°ë ¹ëŒ€ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.</div>
        </div>

        <div class="nav-btns">
          <button class="btn-next" onclick="validateStep1()">ë‹¤ìŒ ë‹¨ê³„</button>
        </div>
      </div>

      <div id="step2" class="step">
        <h2>STEP 2. ìƒì„¸ ì •ë³´ ì„ íƒ</h2>
        <div id="step2-questions"></div>
        <div class="error-msg" id="err_step2">í•„ìˆ˜ í•­ëª©ì„ ì„ íƒí•´ì£¼ì„¸ìš”.</div>

        <div class="nav-btns">
          <button class="btn-prev" onclick="prevStep(1)">ì´ì „</button>
          <button class="btn-next" onclick="validateStep2()">ë‹¤ìŒ ë‹¨ê³„</button>
        </div>
      </div>

      <div id="step3" class="step">
        <h2>STEP 3. ìƒë‹´ í¬ë§ ì‚¬í•­</h2>

        <div class="input-group">
          <label>ìƒë‹´ ë°©ì‹ <span class="req-badge">í•„ìˆ˜</span></label>
          <div class="options">
            <!-- âœ… ì¶”ê°€ + ê¸°ë³¸ ì„ íƒ(checked) -->
            <input type="radio" name="method" id="m0" value="ìƒê´€ì—†ìŒ" checked onchange="updateLive(); clearGroupError('method');" />
            <label for="m0">ìƒê´€ì—†ìŒ</label>

            <input type="radio" name="method" id="m1" value="ì „í™”ìƒë‹´" onchange="updateLive(); clearGroupError('method');" />
            <label for="m1">ì „í™”</label>

            <input type="radio" name="method" id="m2" value="ì¹´í†¡ìƒë‹´" onchange="updateLive(); clearGroupError('method');" />
            <label for="m2">ì¹´í†¡</label>

            <input type="radio" name="method" id="m3" value="ë¬¸ììƒë‹´" onchange="updateLive(); clearGroupError('method');" />
            <label for="m3">ë¬¸ì</label>
          </div>
          <div class="error-msg" id="err_method">ìƒë‹´ ë°©ì‹ì„ ì„ íƒí•´ì£¼ì„¸ìš”.</div>
        </div>

        <div class="input-group">
          <label>í¬ë§ ì‹œê°„ <span class="req-badge">í•„ìˆ˜</span></label>
          <select id="hope_time" onchange="updateLive()">
            <option value="ìƒê´€ì—†ìŒ">ìƒê´€ì—†ìŒ</option>
            <option value="ì˜¤ì „ 9ì‹œ ~ 11ì‹œ">ì˜¤ì „ 9ì‹œ ~ 11ì‹œ</option>
            <option value="ì˜¤ì „ 11ì‹œ ~ ì˜¤í›„ 1ì‹œ">ì˜¤ì „ 11ì‹œ ~ ì˜¤í›„ 1ì‹œ</option>
            <option value="ì˜¤í›„ 1ì‹œ ~ 3ì‹œ">ì˜¤í›„ 1ì‹œ ~ 3ì‹œ</option>
            <option value="ì˜¤í›„ 3ì‹œ ~ 5ì‹œ">ì˜¤í›„ 3ì‹œ ~ 5ì‹œ</option>
            <option value="ì˜¤í›„ 5ì‹œ ~ 6ì‹œ">ì˜¤í›„ 5ì‹œ ~ 6ì‹œ</option>
          </select>
        </div>

        <div class="input-group">
          <label>ê¸°íƒ€ ì§ˆë¬¸ì‚¬í•­</label>
          <textarea id="memo" rows="3" oninput="updateLive()"></textarea>
        </div>

        <div class="nav-btns">
          <button class="btn-prev" onclick="prevStep(2)">ì´ì „</button>
          <button class="btn-next" onclick="finish()">ìµœì¢… ì™„ë£Œ</button>
        </div>
      </div>
    </div>

    <div class="preview-container">
      <!-- âœ… ìµœì¢… í™”ë©´ì—ì„œë„ ëª¨ë°”ì¼/ì¹´ì¹´ì˜¤ ì¸ì•±ì—ì„œ ì´ ë¯¸ë¦¬ë³´ê¸°ê°€ ë³´ì—¬ì•¼ í•¨ -->
      <div id="capture-area" class="summary-card">
        <div class="card-header">ğŸ“‹ êµ¬ëª¬í™”ìƒí•™ìŠµ ì‚¬ì „ ìƒë‹´ì„¤ë¬¸</div>
        <div id="live-content">
          <div class="item"><b>ì´ë¦„:</b> <span id="v-name">-</span></div>
          <div class="item"><b>ì—°ë½ì²˜:</b> <span id="v-phone">-</span></div>
          <div class="item"><b>ì‹ ì²­ì:</b> <span id="v-who">-</span></div>
          <div class="item"><b>êµ¬ë¶„:</b> <span id="v-age">-</span></div>
          <div class="item"><b>í•™ë…„/ì—°ë ¹:</b> <span id="v-grade">-</span></div>
          <div class="item"><b>í•™ìŠµìˆ˜ì¤€:</b> <span id="v-level">-</span></div>
          <div class="item"><b>ê´€ì‹¬ê³¼ëª©:</b> <span id="v-sub">-</span></div>
          <div class="item"><b>ì‹ ì²­ì‚¬ìœ :</b> <span id="v-reason">-</span></div>
          <div class="item"><b>ìƒë‹´ë°©ì‹:</b> <span id="v-method">ìƒê´€ì—†ìŒ</span></div>
          <div class="item"><b>í¬ë§ì‹œê°„:</b> <span id="v-time">ìƒê´€ì—†ìŒ</span></div>
          <div class="item"><b>ê¸°íƒ€ì‚¬í•­:</b> <span id="v-memo">-</span></div>
        </div>
      </div>

      <div id="final-action-area" class="hidden" style="margin-top:20px; display:flex; flex-direction:column; gap:10px;">
        <button id="main-action-btn" class="btn-next" onclick="handleMainAction()">ì´ë¯¸ì§€ ê³µìœ í•˜ê¸°</button>
        <button class="btn-save" id="btn-save-file" onclick="saveImage()">ì´ë¯¸ì§€ íŒŒì¼ ì €ì¥</button>

        <!-- âœ… ì¹´ì¹´ì˜¤ ì¸ì•± í…ìŠ¤íŠ¸ë³µì‚¬ ì‹¤íŒ¨ ì‹œ fallback -->
        <div id="text-fallback" class="text-fallback hidden">
          <div class="tip">
            ìë™ ë³µì‚¬ê°€ ì œí•œë˜ì–´ ìˆì–´ìš”. ì•„ë˜ ë‚´ìš©ì„ <b>ê¸¸ê²Œ ëˆŒëŸ¬ ì „ì²´ì„ íƒ â†’ ë³µì‚¬</b>í•´ì„œ ì¹´í†¡ì— ë¶™ì—¬ë„£ì–´ ì£¼ì„¸ìš”.
          </div>
          <textarea id="result-textarea" readonly></textarea>
          <div class="mini-btns">
            <button type="button" class="btn-outline" onclick="selectFallbackText()">ì „ì²´ì„ íƒ</button>
            <button type="button" class="btn-outline" onclick="tryCopyFallbackText()">ë³µì‚¬ ë‹¤ì‹œ ì‹œë„</button>
          </div>
        </div>

        <button class="btn-reset" onclick="location.reload()">ì²˜ìŒë¶€í„° ë‹¤ì‹œ</button>

        <p class="exit-guide">
          ì „ì†¡ì´ ì™„ë£Œë˜ì…¨ë‹¤ë©´,<br />
          í•´ë‹¹ ì°½ì„ ì¢…ë£Œí•˜ì‹œê±°ë‚˜ ë’¤ë¡œ ê°€ê¸° ë²„íŠ¼ì„ í†µí•´ ì¢…ë£Œí•´ì£¼ì„¸ìš”.
        </p>
      </div>
    </div>
  </div>

  <!-- ëª¨ë°”ì¼ ë¯¸ë¦¬ë³´ê¸° ë°”í…€ì‹œíŠ¸(A) -->
  <div class="sheet-overlay" onclick="closePreviewSheet()"></div>
  <div class="sheet" aria-hidden="true">
    <div class="sheet-inner">
      <div class="sheet-handle"></div>
      <div class="sheet-top">
        <div class="sheet-title">ğŸ“‹ ë¯¸ë¦¬ë³´ê¸°</div>
        <button type="button" class="sheet-close" onclick="closePreviewSheet()">ë‹«ê¸°</button>
      </div>
      <div class="sheet-body">
        <div class="summary-card" style="position:static; border-width:1px;">
          <div class="card-header">ğŸ“‹ êµ¬ëª¬í™”ìƒí•™ìŠµ ì‚¬ì „ ìƒë‹´ì„¤ë¬¸</div>
          <div id="live-content-sheet"></div>
        </div>
      </div>
    </div>
  </div>

  <script>
    function autoHyphen(obj) {
      let str = obj.value.replace(/[^0-9]/g, '');
      if (str.length < 4) { obj.value = str; }
      else if (str.length < 7) { obj.value = str.substr(0, 3) + '-' + str.substr(3); }
      else if (str.length < 11) { obj.value = str.substr(0, 3) + '-' + str.substr(3, 3) + '-' + str.substr(6); }
      else { obj.value = str.substr(0, 3) + '-' + str.substr(3, 4) + '-' + str.substr(7); }
    }

    let currentStep = 1;

    function nextStep(n) {
      document.querySelectorAll('.step').forEach(s => s.classList.remove('active'));
      document.getElementById(`step${n}`).classList.add('active');
      currentStep = n;
      updateProgressUI();
      window.scrollTo(0,0);
    }

    function prevStep(n) {
      document.querySelectorAll('.step').forEach(s => s.classList.remove('active'));
      document.getElementById(`step${n}`).classList.add('active');
      currentStep = n;
      updateProgressUI();
    }

    function updateProgressUI(){
      const bar = document.getElementById('progress-bar');
      const txt = document.getElementById('progress-text');
      const width = currentStep === 1 ? 33 : currentStep === 2 ? 66 : 100;
      bar.style.width = width + '%';
      txt.innerText = `STEP ${currentStep} / 3`;

      const p1 = document.getElementById('pill1');
      const p2 = document.getElementById('pill2');
      const p3 = document.getElementById('pill3');
      [p1,p2,p3].forEach(p => p.classList.remove('active','done'));

      if(currentStep === 1){ p1.classList.add('active'); }
      if(currentStep === 2){ p1.classList.add('done'); p2.classList.add('active'); }
      if(currentStep === 3){ p1.classList.add('done'); p2.classList.add('done'); p3.classList.add('active'); }
    }

    function setFieldError(fieldId, message){
      const el = document.getElementById(fieldId);
      const err = document.getElementById('err_' + fieldId);
      if(el){ el.classList.add('is-error'); el.setAttribute('aria-invalid','true'); }
      if(err){
        if(message) err.innerText = message;
        err.classList.add('show');
      }
    }
    function clearFieldError(fieldId){
      const el = document.getElementById(fieldId);
      const err = document.getElementById('err_' + fieldId);
      if(el){ el.classList.remove('is-error'); el.removeAttribute('aria-invalid'); }
      if(err){ err.classList.remove('show'); }
    }
    function setGroupError(groupName){
      const err = document.getElementById('err_' + groupName);
      if(err) err.classList.add('show');
    }
    function clearGroupError(groupName){
      const err = document.getElementById('err_' + groupName);
      if(err) err.classList.remove('show');
    }

    function validateStep1() {
      let ok = true;

      const nameVal = document.getElementById('in_name').value.trim();
      const phoneVal = document.getElementById('in_phone').value.trim();
      const whoChecked = document.querySelector('input[name="who"]:checked');
      const ageChecked = document.querySelector('input[name="main_age"]:checked');

      if(!nameVal){ setFieldError('in_name', 'ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.'); ok = false; } else { clearFieldError('in_name'); }
      if(!phoneVal){ setFieldError('in_phone', 'ì—°ë½ì²˜ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.'); ok = false; } else { clearFieldError('in_phone'); }
      if(!whoChecked){ setGroupError('who'); ok = false; } else { clearGroupError('who'); }
      if(!ageChecked){ setGroupError('main_age'); ok = false; } else { clearGroupError('main_age'); }

      if(!ok) return alert("í•„ìˆ˜ í•­ëª©ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.");

      renderStep2(ageChecked.value);
      nextStep(2);
    }

    function renderStep2(type) {
      const container = document.getElementById('step2-questions');
      const subjects = ['êµ­ì–´','ìˆ˜í•™','ê³¼í•™','ì˜ì–´','ì¤‘êµ­ì–´','ì¼ë³¸ì–´','í•œì'];
      const subHtml = subjects.map(s => `
        <input type="checkbox" name="subject" id="s_${s}" value="${s}" onchange="updateLive()">
        <label for="s_${s}">${s}</label>
      `).join('');

      let html = '';
      if(type === 'ì¤‘ë“±' || type === 'ê³ ë“±') {
        const grades = type === 'ì¤‘ë“±' ? ['ì¤‘1','ì¤‘2','ì¤‘3'] : ['ê³ 1','ê³ 2','ê³ 3'];
        html = `
          <div class="input-group">
            <label>í•™ë…„ <span class="req-badge">í•„ìˆ˜</span></label>
            <div class="options">
              ${grades.map(g => `
                <input type="radio" name="grade" id="${g}" value="${g}" onchange="updateLive(); document.getElementById('err_step2').classList.remove('show');">
                <label for="${g}">${g}</label>
              `).join('')}
            </div>
          </div>

          <div class="input-group">
            <label>í•™ìŠµ ìˆ˜ì¤€ <span class="req-badge">í•„ìˆ˜</span></label>
            <div class="options">
              <input type="radio" name="level" id="l1" value="ìƒìœ„ê¶Œ" onchange="updateLive()"><label for="l1">ìƒìœ„ê¶Œ</label>
              <input type="radio" name="level" id="l2" value="ì¤‘ìœ„ê¶Œ" onchange="updateLive()"><label for="l2">ì¤‘ìœ„ê¶Œ</label>
              <input type="radio" name="level" id="l3" value="í•˜ìœ„ê¶Œ" onchange="updateLive()"><label for="l3">í•˜ìœ„ê¶Œ</label>
            </div>
          </div>

          <div class="input-group">
            <label>ê³¼ëª© (ë³µìˆ˜ì„ íƒ)</label>
            <div class="options">${subHtml}</div>
          </div>

          <div class="input-group">
            <label>ì‹ ì²­ ì‚¬ìœ </label>
            <div class="options" style="grid-template-columns:1fr;">
              ${['ì„ í–‰í•™ìŠµ','ê¸°ì´ˆë³´ì¶©','ì‘ìš©ë ¥í–¥ìƒ','ìŠµê´€í˜•ì„±','ì·¨ë¯¸'].map(r => `
                <input type="checkbox" name="reason" id="${r}" value="${r}" onchange="updateLive()">
                <label for="${r}">${r}</label>
              `).join('')}
            </div>
          </div>
        `;
      } else {
        html = `
          <div class="input-group">
            <label>ì—°ë ¹ëŒ€ <span class="req-badge">í•„ìˆ˜</span></label>
            <div class="options">
              <input type="radio" name="grade" id="a1" value="20ëŒ€" onchange="updateLive(); document.getElementById('err_step2').classList.remove('show');"><label for="a1">20ëŒ€</label>
              <input type="radio" name="grade" id="a2" value="30ëŒ€" onchange="updateLive(); document.getElementById('err_step2').classList.remove('show');"><label for="a2">30ëŒ€</label>
              <input type="radio" name="grade" id="a3" value="40ëŒ€" onchange="updateLive(); document.getElementById('err_step2').classList.remove('show');"><label for="a3">40ëŒ€</label>
              <input type="radio" name="grade" id="a4" value="50ëŒ€ ì´ìƒ" onchange="updateLive(); document.getElementById('err_step2').classList.remove('show');"><label for="a4">50ëŒ€ ì´ìƒ</label>
            </div>
          </div>

          <div class="input-group">
            <label>ê³¼ëª© (ë³µìˆ˜ì„ íƒ)</label>
            <div class="options">${subHtml}</div>
          </div>

          <div class="input-group">
            <label>ì‹ ì²­ ì‚¬ìœ </label>
            <div class="options" style="grid-template-columns:1fr;">
              ${['ê¸°ì´ˆë³´ì¶©','ìŠµê´€í˜•ì„±','ìê¸°ê³„ë°œ','ì·¨ë¯¸í™œë™'].map(r => `
                <input type="checkbox" name="reason" id="${r}" value="${r}" onchange="updateLive()">
                <label for="${r}">${r}</label>
              `).join('')}
            </div>
          </div>
        `;
      }

      container.innerHTML = html;
      document.getElementById('err_step2').classList.remove('show');
      updateLive();
    }

    function validateStep2() {
      if(!document.querySelector('input[name="grade"]:checked')){
        document.getElementById('err_step2').classList.add('show');
        return alert("í•„ìˆ˜ í•­ëª©ì„ ì„ íƒí•´ì£¼ì„¸ìš”.");
      }
      document.getElementById('err_step2').classList.remove('show');
      nextStep(3);
    }

    function updateLive() {
      document.getElementById('v-name').innerText = document.getElementById('in_name').value || '-';
      document.getElementById('v-phone').innerText = document.getElementById('in_phone').value || '-';
      document.getElementById('v-who').innerText = document.querySelector('input[name="who"]:checked')?.value || '-';
      document.getElementById('v-age').innerText = document.querySelector('input[name="main_age"]:checked')?.value || '-';
      document.getElementById('v-grade').innerText = document.querySelector('input[name="grade"]:checked')?.value || '-';
      document.getElementById('v-level').innerText = document.querySelector('input[name="level"]:checked')?.value || 'í•´ë‹¹ì—†ìŒ';
      document.getElementById('v-sub').innerText = Array.from(document.querySelectorAll('input[name="subject"]:checked')).map(el => el.value).join(', ') || '-';
      document.getElementById('v-reason').innerText = Array.from(document.querySelectorAll('input[name="reason"]:checked')).map(el => el.value).join(', ') || '-';

      // âœ… ê¸°ë³¸ê°’ 'ìƒê´€ì—†ìŒ' ì²´í¬ë˜ì–´ ìˆìœ¼ë¯€ë¡œ ì •ìƒ ë°˜ì˜ë¨
      document.getElementById('v-method').innerText = document.querySelector('input[name="method"]:checked')?.value || 'ìƒê´€ì—†ìŒ';

      document.getElementById('v-time').innerText = document.getElementById('hope_time').value;
      document.getElementById('v-memo').innerText = document.getElementById('memo').value || '-';

      const live = document.getElementById('live-content');
      const sheet = document.getElementById('live-content-sheet');
      if(live && sheet) sheet.innerHTML = live.innerHTML;
    }

    function openPreviewSheet(){ updateLive(); document.body.classList.add('sheet-open'); }
    function closePreviewSheet(){ document.body.classList.remove('sheet-open'); }

    const ua = navigator.userAgent.toLowerCase();
    const isKakaoInApp = ua.indexOf('kakaotalk') !== -1;      // âœ… ì¹´ì¹´ì˜¤ ì¸ì•±
    const isMobile = /iphone|ipad|ipod|android/i.test(ua);

    function finish() {
      // âœ… ê¸°ë³¸ ì„ íƒì´ ìˆìœ¼ë¯€ë¡œ ëŒ€ë¶€ë¶„ í†µê³¼í•˜ì§€ë§Œ, í˜¹ì‹œ DOM ë³€ê²½/ë²„ê·¸ ëŒ€ë¹„í•´ ìœ ì§€
      if(!document.querySelector('input[name="method"]:checked')){
        setGroupError('method');
        return alert("ìƒë‹´ ë°©ì‹ì„ ì„ íƒí•´ì£¼ì„¸ìš”.");
      }
      clearGroupError('method');

      updateLive();
      closePreviewSheet();

      document.getElementById('form-side').classList.add('hidden');
      document.getElementById('final-action-area').classList.remove('hidden');

      const mainBtn = document.getElementById('main-action-btn');
      const saveBtn = document.getElementById('btn-save-file');
      const fallback = document.getElementById('text-fallback');

      fallback.classList.add('hidden');

      if (isKakaoInApp) {
        mainBtn.innerText = "ìƒë‹´ë‚´ìš© ë³µì‚¬í•˜ê¸°";
        saveBtn.classList.add('hidden');
      } else if (isMobile) {
        mainBtn.innerText = "ì´ë¯¸ì§€ ê³µìœ í•˜ê¸°";
        saveBtn.classList.remove('hidden');
      } else {
        mainBtn.innerText = "ì´ë¯¸ì§€ ë³µì‚¬í•˜ê¸°(ë°”ë¡œ ë¶™ì—¬ë„£ê¸°)";
        saveBtn.classList.remove('hidden');
      }

      window.scrollTo(0,0);
    }

    /* âœ… ìƒë‹´ê²°ê³¼ í…ìŠ¤íŠ¸ ìƒì„± */
    function buildResultText(){
      const name = document.getElementById('v-name').innerText || '-';
      const phone = document.getElementById('v-phone').innerText || '-';
      const who = document.getElementById('v-who').innerText || '-';
      const age = document.getElementById('v-age').innerText || '-';
      const grade = document.getElementById('v-grade').innerText || '-';
      const level = document.getElementById('v-level').innerText || '-';
      const sub = document.getElementById('v-sub').innerText || '-';
      const reason = document.getElementById('v-reason').innerText || '-';
      const method = document.getElementById('v-method').innerText || 'ìƒê´€ì—†ìŒ';
      const time = document.getElementById('v-time').innerText || 'ìƒê´€ì—†ìŒ';
      const memo = document.getElementById('v-memo').innerText || '-';

      return [
        "ğŸ“‹ êµ¬ëª¬í™”ìƒí•™ìŠµ ì‚¬ì „ ìƒë‹´ì„¤ë¬¸",
        "",
        `â€¢ ì´ë¦„: ${name}`,
        `â€¢ ì—°ë½ì²˜: ${phone}`,
        `â€¢ ì‹ ì²­ì: ${who}`,
        `â€¢ êµ¬ë¶„: ${age}`,
        `â€¢ í•™ë…„/ì—°ë ¹: ${grade}`,
        `â€¢ í•™ìŠµìˆ˜ì¤€: ${level}`,
        `â€¢ ê´€ì‹¬ê³¼ëª©: ${sub}`,
        `â€¢ ì‹ ì²­ì‚¬ìœ : ${reason}`,
        `â€¢ ìƒë‹´ë°©ì‹: ${method}`,
        `â€¢ í¬ë§ì‹œê°„: ${time}`,
        `â€¢ ê¸°íƒ€ì‚¬í•­: ${memo}`
      ].join("\n");
    }

    /* âœ… ì¹´ì¹´ì˜¤ ì¸ì•±: í…ìŠ¤íŠ¸ ë³µì‚¬(ì‹¤íŒ¨ ì‹œ textarea fallback) */
    async function copyResultText(){
      updateLive();
      const text = buildResultText();

      try{
        if(navigator.clipboard && navigator.clipboard.writeText){
          await navigator.clipboard.writeText(text);
          alert("ë³µì‚¬ ì™„ë£Œ! ì´ì œ í•´ë‹¹ ì°½ì„ ì¢…ë£Œí•˜ê³  êµ¬ëª¬í™”ìƒí•™ìŠµ ì±„íŒ…ì°½ì— ë°”ë¡œ ë¶™ì—¬ë„£ê¸° í•´ì£¼ì‹œë©´ ë©ë‹ˆë‹¤.");
          return true;
        }
        throw new Error("clipboard not available");
      } catch(e){
        showTextFallback(text);
        alert("ìë™ ë³µì‚¬ê°€ ì œí•œë˜ì–´ ìˆì–´ìš”. ì•„ë˜ ë°•ìŠ¤ì—ì„œ ì „ì²´ì„ íƒ í›„ ë³µì‚¬í•´ì£¼ì„¸ìš”.");
        return false;
      }
    }

    function showTextFallback(text){
      const box = document.getElementById('text-fallback');
      const ta = document.getElementById('result-textarea');
      ta.value = text;
      box.classList.remove('hidden');
      setTimeout(()=>{ ta.focus(); ta.select(); }, 100);
    }

    function selectFallbackText(){
      const ta = document.getElementById('result-textarea');
      ta.focus();
      ta.select();
    }

    async function tryCopyFallbackText(){
      const ta = document.getElementById('result-textarea');
      const text = ta.value || "";
      try{
        if(navigator.clipboard && navigator.clipboard.writeText){
          await navigator.clipboard.writeText(text);
          alert("ë³µì‚¬ ì™„ë£Œ! ì¹´ì¹´ì˜¤í†¡ ì±„íŒ…ì°½ì— ë¶™ì—¬ë„£ê¸° í•´ì£¼ì„¸ìš”.");
        } else {
          ta.focus(); ta.select();
          const ok = document.execCommand && document.execCommand('copy');
          if(ok) alert("ë³µì‚¬ ì™„ë£Œ! ì¹´ì¹´ì˜¤í†¡ ì±„íŒ…ì°½ì— ë¶™ì—¬ë„£ê¸° í•´ì£¼ì„¸ìš”.");
          else alert("ë³µì‚¬ê°€ ì œí•œë©ë‹ˆë‹¤. 'ì „ì²´ì„ íƒ' í›„ ìˆ˜ë™ìœ¼ë¡œ ë³µì‚¬í•´ì£¼ì„¸ìš”.");
        }
      } catch(e){
        alert("ë³µì‚¬ê°€ ì œí•œë©ë‹ˆë‹¤. 'ì „ì²´ì„ íƒ' í›„ ìˆ˜ë™ìœ¼ë¡œ ë³µì‚¬í•´ì£¼ì„¸ìš”.");
      }
    }

    /* âœ… ìº¡ì²˜ ì•ˆì •í™”: í°íŠ¸ ë¡œë”© ëŒ€ê¸°(ì§€ì›ë  ë•Œë§Œ, ìµœëŒ€ 1ì´ˆ) */
    async function waitForFonts(timeoutMs = 1000){
      try{
        if(document.fonts && document.fonts.ready){
          await Promise.race([
            document.fonts.ready,
            new Promise(res => setTimeout(res, timeoutMs))
          ]);
        }
      } catch(e){}
    }

    let isWorking = false;

    async function makeCanvasFromCaptureArea(){
      await waitForFonts(1000);
      updateLive();

      const area = document.getElementById('capture-area');

      const prevFont = area.style.fontFamily;
      area.style.fontFamily = "Pretendard, -apple-system, system-ui, sans-serif";

      try{
        const canvas = await html2canvas(area, {
          scale: 2,
          backgroundColor: "#ffffff",
          useCORS: true,
          logging: false
        });
        return canvas;
      } finally {
        area.style.fontFamily = prevFont;
      }
    }

    /* âœ… ë©”ì¸ ì•¡ì…˜: ì¹´ì¹´ì˜¤ ì¸ì•±=í…ìŠ¤íŠ¸ë³µì‚¬ / ê·¸ ì™¸=ê¸°ì¡´ ì´ë¯¸ì§€ */
    async function handleMainAction() {
      if(isWorking) return;
      isWorking = true;

      const mainBtn = document.getElementById('main-action-btn');
      const prevText = mainBtn.innerText;
      mainBtn.innerText = "ì²˜ë¦¬ ì¤‘...";
      mainBtn.style.opacity = "0.8";

      try{
        if(isKakaoInApp){
          await copyResultText();
          return;
        }

        const canvas = await makeCanvasFromCaptureArea();
        const blob = await new Promise((resolve) => canvas.toBlob(resolve, 'image/png'));
        if(!blob) throw new Error("toBlob failed");

        if (isMobile && navigator.share) {
          const fileName = `ìƒë‹´ì‹ ì²­_${document.getElementById('in_name').value || 'ê²°ê³¼'}.png`;
          const file = new File([blob], fileName, { type: "image/png" });
          try {
            await navigator.share({ files: [file], title: 'êµ¬ëª¬í™”ìƒí•™ìŠµ ì‚¬ì „ ìƒë‹´ì„¤ë¬¸' });
          } catch (err) {
            await saveImageFromBlob(blob);
            alert("ê³µìœ ê°€ ì·¨ì†Œë˜ì—ˆê±°ë‚˜ ì§€ì›ë˜ì§€ ì•Šì•„ ì´ë¯¸ì§€ë¡œ ì €ì¥í–ˆìŠµë‹ˆë‹¤.");
          }
          return;
        }

        try {
          if (navigator.clipboard && window.ClipboardItem) {
            const data = [new ClipboardItem({ [blob.type]: blob })];
            await navigator.clipboard.write(data);
            alert("ë³µì‚¬ ì„±ê³µ! ì¹´í†¡ì°½ì— ë¶™ì—¬ë„£ê¸°(Ctrl+V) í•˜ì„¸ìš”.");
          } else {
            await saveImageFromBlob(blob);
            alert("ë³µì‚¬ ê¸°ëŠ¥ì„ ì§€ì›í•˜ì§€ ì•Šì•„ ì´ë¯¸ì§€ë¡œ ì €ì¥í–ˆìŠµë‹ˆë‹¤.");
          }
        } catch (err) {
          await saveImageFromBlob(blob);
          alert("ë³µì‚¬ê°€ ë¶ˆê°€ëŠ¥í•˜ì—¬ ì´ë¯¸ì§€ë¡œ ì €ì¥í–ˆìŠµë‹ˆë‹¤.");
        }

      } catch(e){
        console.error("[ACTION ERROR]", e);
        alert("ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.");
      } finally{
        mainBtn.innerText = prevText;
        mainBtn.style.opacity = "1";
        isWorking = false;
      }
    }

    async function saveImage() {
      if(isWorking) return;
      isWorking = true;

      const saveBtn = document.getElementById('btn-save-file');
      const prevText = saveBtn.innerText;
      saveBtn.innerText = "ì €ì¥ ì¤‘...";
      saveBtn.style.opacity = "0.8";

      try{
        const canvas = await makeCanvasFromCaptureArea();
        const blob = await new Promise((resolve) => canvas.toBlob(resolve, 'image/png'));
        if(!blob) throw new Error("toBlob failed");
        await saveImageFromBlob(blob);
      } catch(e){
        console.error("[SAVE ERROR]", e);
        alert("ì´ë¯¸ì§€ ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.");
      } finally{
        saveBtn.innerText = prevText;
        saveBtn.style.opacity = "1";
        isWorking = false;
      }
    }

    async function saveImageFromBlob(blob){
      const fileName = `ìƒë‹´ì‹ ì²­_${document.getElementById('in_name').value || 'ê²°ê³¼'}.png`;
      const url = URL.createObjectURL(blob);

      try{
        const a = document.createElement('a');
        a.href = url;
        a.download = fileName;
        document.body.appendChild(a);
        a.click();
        a.remove();
      } catch(e){
        window.open(url, "_blank");
      } finally{
        setTimeout(() => URL.revokeObjectURL(url), 2000);
      }
    }

    // ì´ˆê¸° ìƒíƒœ
    updateProgressUI();
    updateLive();

    document.addEventListener('keydown', (e) => {
      if(e.key === 'Escape') closePreviewSheet();
    });
  </script>
</body>
</html>
